name        : firefox
version     : 41.0.1
release     : 31
source     :
    - https://ftp.mozilla.org/pub/mozilla.org/firefox/releases/41.0.1/source/firefox-41.0.1.source.tar.xz : 47b2cfc26b17559c26b95a584ab14b6efba132ca371b8aa30da2e2167e0612c3
license     :
    - GPL-2.0+
    - MPL-2.0
summary     : Firefox web browser
builddeps   :
    - pkgconfig(libevent)
    - pkgconfig(gtk+-3.0)
    - pkgconfig(gtk+-2.0)
    - pkgconfig(cairo)
    - pkgconfig(atk)
    - pkgconfig(libstartup-notification-1.0)
    - pkgconfig(alsa)
    - pkgconfig(libpulse)
    - pkgconfig(gstreamer-plugins-base-1.0)
    - pkgconfig(x11)
    - pkgconfig(xt)
    - pkgconfig(icu-i18n)
    - pkgconfig(sqlite3)
    - pkgconfig(gconf-2.0)
    - pkgconfig(xcomposite)
    - libjpeg-turbo-devel
    - yasm
description : |
    Firefox web browser
setup      : |
    # GTK3 fixes
    %patch -p1 < $pkgfiles/gtk3/mozilla-1144745-3.patch
    %patch -p1 < $pkgfiles/gtk3/mozilla-1160154.patch
    %patch -p1 < $pkgfiles/gtk3/mozilla-1169233.patch
    %patch -p1 < $pkgfiles/gtk3/mozilla-1169232.patch
    %patch -p1 < $pkgfiles/gtk3/mozilla-1129873-apppicker.patch
    %patch -p2 < $pkgfiles/gtk3/mozilla-entry-padding.patch
    
    
    install $pkgfiles/config mozconfig
    sed 's@\#\#JOBCOUNT\#\#@%JOBS%@' -i mozconfig
    
    echo "ac_add_options --libdir=%libdir%" >> mozconfig
build      : |
    unset LD_AS_NEEDED
    %make -f client.mk
install    : |
    unset LD_AS_NEEDED
    %make_install -f client.mk install INSTALL_SDK= 
    
    mkdir -p $installdir/usr/share/pixmaps
    ln -sv %libdir%/firefox-${version}/browser/icons/mozicon128.png $installdir/usr/share/pixmaps/firefox.png
    
    mkdir -p $installdir/%libdir%/plugins
    ln -sv %libdir%/mozilla/plugins $installdir/%libdir%/firefox-${version}/plugins
    
    
    install -D -m 00644 $pkgfiles/firefox.desktop $installdir/usr/share/applications/firefox.desktop
